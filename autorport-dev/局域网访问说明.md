# 🌐 局域网访问配置说明

AutoReportAI 已支持局域网访问，让团队其他成员可以通过局域网IP访问您的开发环境。

## 🚀 快速启动（推荐）

### 方法1：使用启动脚本自动配置
```bash
# 进入项目目录
cd autorport-dev

# 启动部署环境（自动检测IP）
./start.sh deployment

# 或使用代理环境（企业网络）
./start.sh proxy
```

启动脚本会自动：
- 检测您的局域网IP地址
- 更新环境配置文件
- 配置CORS允许局域网访问
- 显示所有可用的访问地址

### 方法2：交互式配置
```bash
# 交互式配置启动
./start.sh interactive

# 按提示选择环境模式和自定义IP地址
```

## 📱 访问地址

启动成功后，您将看到类似输出：

```
🚀 AutoReportAI 启动成功
--------------------------------------------------
🌐 局域网访问模式 (IP: 192.168.1.100)
📱 前端地址: http://192.168.1.100:3000
🔗 后端API: http://192.168.1.100:8000/api/v1
🌐 WebSocket: ws://192.168.1.100:8000/ws
📋 API文档: http://192.168.1.100:8000/docs
💻 本地访问: http://localhost:3000
🔧 运行环境: development
--------------------------------------------------
```

## 🔧 手动配置

如需手动指定IP地址或高级配置：

1. **使用交互式配置** (推荐)
   ```bash
   ./start.sh interactive
   ```
   脚本会引导您完成所有配置，包括自定义IP地址

2. **手动编辑环境文件**
   ```bash
   # 创建环境文件
   cp .env.example .env
   
   # 编辑 .env 文件，修改以下配置：
   # SERVER_IP=您的局域网IP (例如: 192.168.1.100)
   # NEXT_PUBLIC_API_URL=http://您的IP:8000/api/v1  
   # NEXT_PUBLIC_WS_URL=ws://您的IP:8000/ws
   ```

3. **启动服务**
   ```bash
   # 使用现有的 .env 配置启动
   ./start.sh full
   ```

**注意**: start.sh 脚本会自动检测和更新IP配置，大多数情况下无需手动配置。

## 🔐 安全注意事项

1. **防火墙设置**
   - 确保端口 3000（前端）和 8000（后端）在防火墙中开放
   - 仅在受信任的网络环境中启用局域网访问

2. **生产环境**
   - 局域网访问主要用于开发和测试
   - 生产环境请使用专用的域名和SSL证书

3. **网络隔离**
   - 建议在隔离的开发网络中使用
   - 避免在公共网络中暴露开发服务

## 🛠️ 故障排除

### 无法通过局域网访问
1. 检查防火墙设置
2. 确认IP地址正确
3. 验证CORS配置
4. 检查网络连通性

### IP地址检测错误
```bash
# 手动获取正确的IP
ip route get 8.8.8.8 | grep -oE 'src [0-9.]+' | awk '{print $2}'

# 或在macOS上
ifconfig | grep "inet " | grep -v 127.0.0.1 | head -1 | awk '{print $2}'
```

### 服务启动失败
1. 检查端口占用情况
2. 查看Docker容器状态
3. 检查日志输出

## 📞 获取帮助

如有问题，请：
1. 查看服务状态：`./start.sh status`
2. 查看日志：`./start.sh logs`
3. 重启服务：`./start.sh restart`

---

## 🎨 前端优化

前端已经针对局域网访问进行了优化：

- ✅ **自动IP检测**: 前端会自动适配局域网访问配置
- ✅ **开发热重载**: 支持局域网下的开发热重载
- ✅ **WebSocket连接**: 自动配置局域网WebSocket连接
- ✅ **响应式适配**: 自动适应不同设备的局域网访问

## 🔄 配置更新逻辑

start.sh 脚本的自动配置功能：

1. **IP自动检测**: 检测本机局域网IP地址
2. **配置自动更新**: 自动更新 `.env` 文件中的所有相关配置
3. **CORS自动配置**: 自动添加局域网IP到CORS允许列表
4. **前端API自动配置**: 自动更新前端的API和WebSocket地址

---

💡 **提示**：首次使用建议运行 `./start.sh deployment`，这会自动配置所有必要的设置。