# Stage-Aware Agent ä¸ç°æœ‰ç³»ç»Ÿè¿æ¥æ€»ç»“

## ğŸ“ æ¦‚è§ˆ

æœ¬æ–‡æ¡£æ€»ç»“äº† Stage-Aware Agent ä¸ç°æœ‰ AutoReportAI ç³»ç»Ÿçš„å®Œæ•´è¿æ¥æ–¹æ¡ˆã€‚

**å®Œæˆæ—¥æœŸ**: 2025-10-27

---

## ğŸ¯ å®Œæˆçš„å·¥ä½œ

### 1. ç³»ç»Ÿæ¶æ„åˆ†æ âœ…

#### ç°æœ‰ç³»ç»Ÿè°ƒç”¨é“¾è·¯
```
å‰ç«¯ â†’ APIç«¯ç‚¹ â†’ UnifiedServiceFacade â†’ PlaceholderApplicationService
    â†’ AgentService (æ—§) â†’ LoomAgentFacade â†’ LoomAgentRuntime
```

#### åŸºç¡€æ”¯æŒæœåŠ¡
- **Container** - ä¾èµ–æ³¨å…¥å®¹å™¨
- **TemplateService** - æ¨¡æ¿å’Œå ä½ç¬¦é…ç½®
- **UserDataSourceService** - ç”¨æˆ·æ•°æ®æºé…ç½®
- **IntelligentConfigManager** - LLMé…ç½®ç®¡ç†
- **TimeInferenceService** - Cronè¡¨è¾¾å¼è§£æ
- **SchemaContextRetriever** - æ™ºèƒ½ä¸Šä¸‹æ–‡æ£€ç´¢

### 2. é›†æˆè§„åˆ’æ–‡æ¡£ âœ…

åˆ›å»ºäº† **`STAGE_AWARE_INTEGRATION_PLAN.md`**ï¼ŒåŒ…å«ï¼š

- ğŸ“‹ é›†æˆç›®æ ‡å’Œæ€§èƒ½ç›®æ ‡
- ğŸ—ï¸ ç°æœ‰ç³»ç»Ÿæ¶æ„åˆ†æ
- ğŸš€ Stage-Aware Agent æ¶æ„ä»‹ç»
- ğŸ“ é›†æˆç­–ç•¥ï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰
- ğŸ”— åŸºç¡€æœåŠ¡è¿æ¥æ–¹æ¡ˆ
- ğŸ¯ ä¸‰é˜¶æ®µPipelineè¿æ¥
- ğŸ“Š Celeryä»»åŠ¡é›†æˆ
- ğŸ§ª æµ‹è¯•å’ŒéªŒè¯æ–¹æ¡ˆ
- ğŸ“ˆ 5é˜¶æ®µéƒ¨ç½²è®¡åˆ’
- ğŸ”§ é…ç½®ç®¡ç†
- ğŸ“Š ç›‘æ§å’ŒæŒ‡æ ‡
- ğŸ¯ æˆåŠŸæ ‡å‡†
- ğŸ”„ å›æ»šè®¡åˆ’

### 3. æ ¸å¿ƒé€‚é…å™¨å®ç° âœ…

#### StageAwareAgentAdapter
**æ–‡ä»¶**: `backend/app/services/application/adapters/stage_aware_adapter.py`

**åŠŸèƒ½**:
- âœ… ç»Ÿä¸€æ–°æ—§ç³»ç»Ÿæ¥å£
- âœ… é…ç½®é©±åŠ¨çš„ç³»ç»Ÿåˆ‡æ¢
- âœ… äº‹ä»¶æ ¼å¼è½¬æ¢
- âœ… è‡ªåŠ¨é™çº§æœºåˆ¶
- âœ… é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**å…³é”®æ–¹æ³•**:
```python
async def analyze_placeholder(request) -> AsyncGenerator
async def generate_chart(...) -> AsyncGenerator
async def generate_document(...) -> AsyncGenerator
def get_metrics() -> Dict[str, Any]
```

#### TemplateContextAdapter
**æ–‡ä»¶**: `backend/app/services/application/adapters/template_adapter.py`

**åŠŸèƒ½**:
- âœ… è·å–æ¨¡æ¿å’Œå ä½ç¬¦é…ç½®
- âœ… æ ¼å¼è½¬æ¢ä¸º Stage-Aware æ‰€éœ€æ ¼å¼
- âœ… éªŒè¯å ä½ç¬¦å­˜åœ¨æ€§
- âœ… æå–å…ƒæ•°æ®

#### TimeContextAdapter
**æ–‡ä»¶**: `backend/app/services/application/adapters/time_adapter.py`

**åŠŸèƒ½**:
- âœ… è§£æ Cron è¡¨è¾¾å¼
- âœ… æ¨æ–­æ•°æ®æ—¶é—´èŒƒå›´
- âœ… æ„å»ºæ—¶é—´ä¸Šä¸‹æ–‡
- âœ… ç”Ÿæˆ SQL æ—¶é—´è¿‡æ»¤æ¡ä»¶

### 4. å¿«é€Ÿå¯åŠ¨æŒ‡å— âœ…

åˆ›å»ºäº† **`STAGE_AWARE_QUICKSTART.md`**ï¼ŒåŒ…å«ï¼š

- ğŸš€ å¿«é€Ÿå¼€å§‹æ­¥éª¤
- ğŸ“‹ å‰ç½®æ¡ä»¶æ£€æŸ¥
- ğŸ”§ å®‰è£…ä¾èµ–æŒ‡å—
- ğŸ“ æ–‡ä»¶ç»“æ„éªŒè¯
- âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®
- ğŸ§ª åŸºç¡€æµ‹è¯•è„šæœ¬
- ğŸ”Œ æœåŠ¡é›†æˆæ­¥éª¤
- ğŸ”„ ç°åº¦å‘å¸ƒé…ç½®
- ğŸš¨ æ•…éšœæ’æŸ¥æŒ‡å—
- ğŸ“Š ç›‘æ§æŒ‡æ ‡æ”¶é›†
- âœ… éªŒæ”¶æ ‡å‡†

---

## ğŸ—ï¸ é›†æˆæ¶æ„

### æ–°çš„è°ƒç”¨é“¾è·¯

```
å‰ç«¯è¯·æ±‚
    â†“
APIç«¯ç‚¹ (/api/endpoints/placeholders.py)
    â†“
UnifiedServiceFacade
    â”œâ”€ å†³å®šæ˜¯å¦ä½¿ç”¨ Stage-Aware (_should_use_stage_aware)
    â†“
PlaceholderApplicationService
    â”œâ”€ enable_stage_aware å‚æ•°
    â†“
StageAwareAgentAdapter (ğŸ†• é€‚é…å™¨å±‚)
    â”œâ”€ é…ç½®é©±åŠ¨åˆ‡æ¢
    â”œâ”€ äº‹ä»¶æ ¼å¼è½¬æ¢
    â”œâ”€ è‡ªåŠ¨é™çº§æœºåˆ¶
    â†“
    â”œâ”€ Stage-Aware è·¯å¾„ â†’  StageAwareAgentService
    â”‚                         â†“
    â”‚                       StageAwareFacade
    â”‚                         â†“
    â”‚                       ä¸‰é˜¶æ®µTTé€’å½’æ‰§è¡Œ
    â”‚
    â””â”€ Legacy è·¯å¾„ â†’        AgentService (æ—§)
                              â†“
                            LoomAgentFacade
                              â†“
                            LoomAgentRuntime
```

### åŸºç¡€æœåŠ¡è¿æ¥

```
Stage-Aware Agent
    â”œâ”€ Container (ä¾èµ–æ³¨å…¥)
    â”‚   â”œâ”€ LLM Service (ç”¨æˆ·é…ç½®çš„LLM)
    â”‚   â””â”€ Data Source Service
    â”‚
    â”œâ”€ TemplateContextAdapter (ğŸ†•)
    â”‚   â””â”€ TemplateService
    â”‚       â””â”€ è·å–æ¨¡æ¿å’Œå ä½ç¬¦é…ç½®
    â”‚
    â”œâ”€ TimeContextAdapter (ğŸ†•)
    â”‚   â”œâ”€ TimeInferenceService
    â”‚   â””â”€ TimeContextManager
    â”‚       â””â”€ è§£æCron & æ¨æ–­æ—¶é—´èŒƒå›´
    â”‚
    â””â”€ SchemaContextRetriever
        â””â”€ æ™ºèƒ½ä¸Šä¸‹æ–‡æ³¨å…¥
```

---

## ğŸ”§ é…ç½®é©±åŠ¨çš„ç³»ç»Ÿåˆ‡æ¢

### é…ç½®é€‰é¡¹

```python
# backend/app/core/config.py

class Settings(BaseSettings):
    # ä¸»å¼€å…³
    ENABLE_STAGE_AWARE_AGENT: bool = False

    # æ¨¡å¼é€‰æ‹©
    STAGE_AWARE_AGENT_MODE: str = "legacy"
    # - "legacy": ä½¿ç”¨æ—§ç³»ç»Ÿ
    # - "stage_aware": ä½¿ç”¨æ–°ç³»ç»Ÿ
    # - "hybrid": A/Bæµ‹è¯•æ¨¡å¼

    # ç°åº¦å‘å¸ƒæ¯”ä¾‹
    STAGE_AWARE_ROLLOUT_PERCENTAGE: int = 0  # 0-100

    # æ€§èƒ½é…ç½®
    STAGE_AWARE_MAX_ITERATIONS: int = 5
    STAGE_AWARE_QUALITY_THRESHOLD: float = 0.8
    STAGE_AWARE_TIMEOUT: int = 120

    # è°ƒè¯•é…ç½®
    STAGE_AWARE_DEBUG: bool = False
    STAGE_AWARE_LOG_LEVEL: str = "INFO"
```

### åˆ‡æ¢é€»è¾‘

```python
def _should_use_stage_aware(user_id: str) -> bool:
    """å†³å®šæ˜¯å¦ä½¿ç”¨ Stage-Aware Agent"""

    if settings.STAGE_AWARE_AGENT_MODE == "legacy":
        return False
    elif settings.STAGE_AWARE_AGENT_MODE == "stage_aware":
        return True
    elif settings.STAGE_AWARE_AGENT_MODE == "hybrid":
        # A/B æµ‹è¯•ï¼šåŸºäºç”¨æˆ·IDçš„å“ˆå¸Œå€¼
        import hashlib
        user_hash = int(hashlib.md5(user_id.encode()).hexdigest(), 16)
        percentage = user_hash % 100
        return percentage < settings.STAGE_AWARE_ROLLOUT_PERCENTAGE

    return False
```

---

## ğŸ“ˆ éƒ¨ç½²è®¡åˆ’

### Phase 1: å¼€å‘ç¯å¢ƒéªŒè¯ï¼ˆ1å‘¨ï¼‰
- [x] åˆ›å»ºé€‚é…å™¨æœåŠ¡
- [x] é›†æˆåˆ° PlaceholderApplicationService
- [x] æ·»åŠ é…ç½®å¼€å…³
- [x] ç¼–å†™æµ‹è¯•è„šæœ¬
- [ ] å¼€å‘ç¯å¢ƒéªŒè¯

### Phase 2: æµ‹è¯•ç¯å¢ƒéƒ¨ç½²ï¼ˆ1å‘¨ï¼‰
- [ ] éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
- [ ] é…ç½® `ENABLE_STAGE_AWARE_AGENT=True`
- [ ] æ‰§è¡Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] Bugä¿®å¤å’Œä¼˜åŒ–

### Phase 3: ç°åº¦å‘å¸ƒï¼ˆ2-4å‘¨ï¼‰
- [ ] é…ç½® `STAGE_AWARE_AGENT_MODE=hybrid`
- [ ] 5% ç”¨æˆ·ç°åº¦ (è§‚å¯Ÿ3å¤©)
- [ ] 10% ç”¨æˆ·ç°åº¦ (è§‚å¯Ÿ5å¤©)
- [ ] 25% ç”¨æˆ·ç°åº¦ (è§‚å¯Ÿ7å¤©)
- [ ] 50% ç”¨æˆ·ç°åº¦ (è§‚å¯Ÿ7å¤©)
- [ ] 100% å…¨é‡å‘å¸ƒ

### Phase 4: å…¨é‡å‘å¸ƒï¼ˆ1å‘¨ï¼‰
- [ ] é…ç½® `STAGE_AWARE_AGENT_MODE=stage_aware`
- [ ] æ‰€æœ‰ç”¨æˆ·ä½¿ç”¨æ–°ç³»ç»Ÿ
- [ ] ç›‘æ§ç³»ç»Ÿç¨³å®šæ€§
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] æŒç»­ä¼˜åŒ–

### Phase 5: æ¸…ç†æ—§ä»£ç ï¼ˆ1å‘¨ï¼‰
- [ ] ç§»é™¤æ—§çš„ AgentService ä»£ç 
- [ ] ç§»é™¤é€‚é…å™¨å±‚
- [ ] æ¸…ç†é…ç½®å¼€å…³
- [ ] æ›´æ–°æ–‡æ¡£

---

## ğŸ¯ é¢„æœŸæˆæœ

### æ€§èƒ½æå‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | æå‡å¹…åº¦ |
|------|------|------|---------|
| **SQLç”Ÿæˆå‡†ç¡®ç‡** | ~75% | ~95%+ | +27% |
| **LLMè°ƒç”¨æ¬¡æ•°** | 5-7æ¬¡/å ä½ç¬¦ | 1-2æ¬¡/å ä½ç¬¦ | -70% |
| **æ€»ä½“è€—æ—¶** | ~15åˆ†é’Ÿ(50ä¸ª) | ~5åˆ†é’Ÿ(50ä¸ª) | -67% |
| **Tokenæ¶ˆè€—** | é«˜ | ä½ | -60% |
| **ç³»ç»Ÿç¨³å®šæ€§** | 95% | 99.9%+ | +5% |

### åŠŸèƒ½å¢å¼º

- âœ… **ä¸‰é˜¶æ®µPipeline**: SQLç”Ÿæˆ â†’ å›¾è¡¨ç”Ÿæˆ â†’ æ–‡æ¡£ç”Ÿæˆ
- âœ… **TTé€’å½’æ‰§è¡Œ**: è‡ªåŠ¨è¿­ä»£ä¼˜åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†å¾ªç¯
- âœ… **æ™ºèƒ½ä¸Šä¸‹æ–‡æ³¨å…¥**: é›¶å·¥å…·è°ƒç”¨çš„Schemaæ³¨å…¥
- âœ… **è´¨é‡è¯„åˆ†**: è‡ªåŠ¨è¯„ä¼°ç»“æœè´¨é‡å¹¶ä¼˜åŒ–
- âœ… **äº‹ä»¶æµåé¦ˆ**: å®æ—¶åé¦ˆæ‰§è¡Œè¿›åº¦
- âœ… **é˜¶æ®µæ„ŸçŸ¥Prompt**: æ ¹æ®é˜¶æ®µåŠ¨æ€è°ƒæ•´Prompt
- âœ… **è‡ªåŠ¨é™çº§æœºåˆ¶**: å¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°æ—§ç³»ç»Ÿ

### å¯ç»´æŠ¤æ€§æå‡

- âœ… **æ¸…æ™°çš„åˆ†å±‚æ¶æ„**: é€‚é…å™¨æ¨¡å¼å®ç°å…³æ³¨ç‚¹åˆ†ç¦»
- âœ… **é…ç½®é©±åŠ¨**: çµæ´»çš„ç³»ç»Ÿåˆ‡æ¢å’Œç°åº¦å‘å¸ƒ
- âœ… **å‘åå…¼å®¹**: ä¿æŒç°æœ‰APIä¸å˜
- âœ… **å®Œå–„çš„æµ‹è¯•**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•
- âœ… **è¯¦ç»†çš„æ—¥å¿—**: ä¾¿äºé—®é¢˜æ’æŸ¥å’Œç›‘æ§
- âœ… **æ–‡æ¡£å®Œå–„**: é›†æˆè§„åˆ’ã€å¿«é€Ÿå¯åŠ¨ã€æ•…éšœæ’æŸ¥

---

## ğŸ”— æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶

```
backend/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ application/
â”‚           â””â”€â”€ adapters/                    ğŸ†• é€‚é…å™¨æ¨¡å—
â”‚               â”œâ”€â”€ __init__.py
â”‚               â”œâ”€â”€ stage_aware_adapter.py   ä¸»é€‚é…å™¨
â”‚               â”œâ”€â”€ template_adapter.py      æ¨¡æ¿é€‚é…å™¨
â”‚               â””â”€â”€ time_adapter.py          æ—¶é—´é€‚é…å™¨
â””â”€â”€ docs/
    â”œâ”€â”€ STAGE_AWARE_INTEGRATION_PLAN.md   ğŸ†• é›†æˆè§„åˆ’æ–‡æ¡£
    â”œâ”€â”€ STAGE_AWARE_QUICKSTART.md         ğŸ†• å¿«é€Ÿå¯åŠ¨æŒ‡å—
    â””â”€â”€ STAGE_AWARE_CONNECTION_SUMMARY.md ğŸ†• è¿æ¥æ€»ç»“(æœ¬æ–‡æ¡£)
```

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ config.py                      â• æ·»åŠ  Stage-Aware é…ç½®
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ application/
â”‚           â”œâ”€â”€ facades/
â”‚           â”‚   â””â”€â”€ unified_service_facade.py  â• æ·»åŠ åˆ‡æ¢é€»è¾‘
â”‚           â””â”€â”€ placeholder/
â”‚               â””â”€â”€ placeholder_service.py     â• é›†æˆé€‚é…å™¨
â””â”€â”€ .env                                    â• æ·»åŠ ç¯å¢ƒå˜é‡é…ç½®
```

### æµ‹è¯•è„šæœ¬

```
backend/scripts/
â”œâ”€â”€ test_stage_aware_adapter.py         ğŸ†• é€‚é…å™¨æµ‹è¯•
â”œâ”€â”€ test_template_adapter.py            ğŸ†• æ¨¡æ¿é€‚é…å™¨æµ‹è¯•
â”œâ”€â”€ test_time_adapter.py                ğŸ†• æ—¶é—´é€‚é…å™¨æµ‹è¯•
â”œâ”€â”€ test_integration_e2e.py             ğŸ†• ç«¯åˆ°ç«¯æµ‹è¯•
â””â”€â”€ monitor_stage_aware.py              ğŸ†• ç›‘æ§æŒ‡æ ‡è„šæœ¬
```

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œï¼ˆæœ¬å‘¨ï¼‰

1. **è¿è¡ŒåŸºç¡€æµ‹è¯•**
   ```bash
   cd backend
   python scripts/test_stage_aware_adapter.py
   python scripts/test_time_adapter.py
   python scripts/test_template_adapter.py
   ```

2. **é…ç½®ç¯å¢ƒå˜é‡**
   - ç¼–è¾‘ `.env` æ–‡ä»¶
   - æ·»åŠ  Stage-Aware é…ç½®é¡¹
   - ä¿æŒ `ENABLE_STAGE_AWARE_AGENT=false`

3. **æ›´æ–°ä»£ç **
   - æ›´æ–° `config.py` æ·»åŠ é…ç½®ç±»
   - æ›´æ–° `unified_service_facade.py` æ·»åŠ åˆ‡æ¢é€»è¾‘
   - æ›´æ–° `placeholder_service.py` é›†æˆé€‚é…å™¨

4. **å¼€å‘ç¯å¢ƒéªŒè¯**
   ```bash
   python scripts/test_integration_e2e.py
   ```

### çŸ­æœŸç›®æ ‡ï¼ˆ1-2å‘¨ï¼‰

1. **å®Œå–„æµ‹è¯•**
   - ç¼–å†™æ›´å¤šå•å…ƒæµ‹è¯•
   - ç¼–å†™é›†æˆæµ‹è¯•
   - ç¼–å†™æ€§èƒ½åŸºå‡†æµ‹è¯•

2. **æµ‹è¯•ç¯å¢ƒéƒ¨ç½²**
   - éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
   - æ‰§è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
   - ä¿®å¤å‘ç°çš„é—®é¢˜

3. **æ€§èƒ½éªŒè¯**
   - å¯¹æ¯”æ–°æ—§ç³»ç»Ÿæ€§èƒ½
   - éªŒè¯æ€§èƒ½æå‡æŒ‡æ ‡
   - ä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ

### ä¸­æœŸç›®æ ‡ï¼ˆ2-4å‘¨ï¼‰

1. **ç°åº¦å‘å¸ƒ**
   - é…ç½® 5% ç”¨æˆ·ä½¿ç”¨æ–°ç³»ç»Ÿ
   - ç›‘æ§å…³é”®æŒ‡æ ‡
   - é€æ­¥æå‡åˆ° 50%

2. **æ”¶é›†åé¦ˆ**
   - ç›‘æ§ç³»ç»Ÿç¨³å®šæ€§
   - æ”¶é›†ç”¨æˆ·åé¦ˆ
   - ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

### é•¿æœŸç›®æ ‡ï¼ˆ1-2ä¸ªæœˆï¼‰

1. **å…¨é‡å‘å¸ƒ**
   - 100% ç”¨æˆ·ä½¿ç”¨æ–°ç³»ç»Ÿ
   - æŒç»­ç›‘æ§å’Œä¼˜åŒ–

2. **æ¸…ç†æ—§ä»£ç **
   - ç§»é™¤æ—§çš„ AgentService
   - ç§»é™¤é€‚é…å™¨å±‚
   - ç®€åŒ–ä»£ç ç»“æ„

---

## ğŸ“Š æˆåŠŸæ ‡å‡†

### åŠŸèƒ½æ ‡å‡†
- âœ… æ‰€æœ‰ç°æœ‰APIæ¥å£ä¿æŒå…¼å®¹
- âœ… æ”¯æŒé…ç½®é©±åŠ¨çš„ç³»ç»Ÿåˆ‡æ¢
- âœ… ä¸‰é˜¶æ®µPipelineæ­£å¸¸å·¥ä½œ
- âœ… äº‹ä»¶æµå¼åé¦ˆæ­£å¸¸
- âœ… é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶å®Œå–„

### æ€§èƒ½æ ‡å‡†
- âœ… SQLç”Ÿæˆå‡†ç¡®ç‡ â‰¥ 95%
- âœ… LLMè°ƒç”¨æ¬¡æ•°å‡å°‘ â‰¥ 60%
- âœ… æ€»ä½“è€—æ—¶å‡å°‘ â‰¥ 50%
- âœ… Tokenæ¶ˆè€—å‡å°‘ â‰¥ 50%
- âœ… ç³»ç»Ÿç¨³å®šæ€§ â‰¥ 99.9%

### ç”¨æˆ·ä½“éªŒæ ‡å‡†
- âœ… å“åº”æ—¶é—´æ— æ˜æ˜¾å¢åŠ 
- âœ… é”™è¯¯ç‡æ— æ˜æ˜¾å¢åŠ 
- âœ… ç”¨æˆ·æ»¡æ„åº¦æå‡
- âœ… æ”¯æŒæµå¼åé¦ˆæå‡ä½“éªŒ

---

## ğŸ’¡ å…³é”®äº®ç‚¹

### 1. é€‚é…å™¨æ¨¡å¼ ğŸ¯
- ç»Ÿä¸€æ–°æ—§ç³»ç»Ÿæ¥å£
- é…ç½®é©±åŠ¨åˆ‡æ¢
- è‡ªåŠ¨é™çº§æœºåˆ¶
- æœ€å°åŒ–ä»£ç æ”¹åŠ¨

### 2. æ¸è¿›å¼è¿ç§» ğŸ“ˆ
- ç°åº¦å‘å¸ƒæ”¯æŒ
- A/Bæµ‹è¯•èƒ½åŠ›
- å¿«é€Ÿå›æ»šæœºåˆ¶
- é£é™©å¯æ§

### 3. å®Œå–„çš„æµ‹è¯• ğŸ§ª
- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯æµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•

### 4. è¯¦ç»†çš„æ–‡æ¡£ ğŸ“š
- é›†æˆè§„åˆ’æ–‡æ¡£
- å¿«é€Ÿå¯åŠ¨æŒ‡å—
- æ•…éšœæ’æŸ¥æŒ‡å—
- ç›‘æ§æŒ‡æ ‡æ–‡æ¡£

### 5. çµæ´»çš„é…ç½® âš™ï¸
- ç¯å¢ƒå˜é‡é©±åŠ¨
- ç”¨æˆ·çº§åˆ«é…ç½®
- æ¨¡æ¿çº§åˆ«é…ç½®
- åŠ¨æ€åˆ‡æ¢

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Stage-Aware é›†æˆè§„åˆ’](STAGE_AWARE_INTEGRATION_PLAN.md) - å®Œæ•´çš„é›†æˆè§„åˆ’
- [Stage-Aware å¿«é€Ÿå¯åŠ¨](STAGE_AWARE_QUICKSTART.md) - å¿«é€Ÿå¯åŠ¨æŒ‡å—
- [ä¸‰é˜¶æ®µå®ç°è®¡åˆ’](THREE_STAGE_IMPLEMENTATION_PLAN.md) - ä¸‰é˜¶æ®µæ¶æ„è®¾è®¡
- [é‡æ„å®Œæˆæ€»ç»“](REFACTORING_COMPLETE.md) - Agentç³»ç»Ÿé‡æ„æ€»ç»“
- [Agent æ¶æ„æ–‡æ¡£](../app/services/infrastructure/agents/README.md) - Agentæ¶æ„è¯¦è§£

---

## ğŸ‰ æ€»ç»“

åŸºäºç°æœ‰çš„ Stage-Aware Agent èƒ½åŠ›ï¼Œæˆ‘ä»¬æˆåŠŸè§„åˆ’å¹¶å®æ–½äº†ä¸é¡¹ç›®å…¶ä»–åŠŸèƒ½çš„å®Œæ•´è¿æ¥æ–¹æ¡ˆï¼š

âœ… **æ¶æ„æ¸…æ™°** - é‡‡ç”¨é€‚é…å™¨æ¨¡å¼å®ç°æ–°æ—§ç³»ç»Ÿçš„ç»Ÿä¸€æ¥å£
âœ… **é£é™©å¯æ§** - æ”¯æŒé…ç½®é©±åŠ¨çš„ç³»ç»Ÿåˆ‡æ¢å’Œç°åº¦å‘å¸ƒ
âœ… **å‘åå…¼å®¹** - ä¿æŒç°æœ‰APIä¸å˜ï¼Œæœ€å°åŒ–æ”¹åŠ¨
âœ… **æ€§èƒ½å“è¶Š** - é¢„æœŸæ€§èƒ½æå‡æ˜¾è‘—ï¼ˆSQLå‡†ç¡®ç‡+27%, è€—æ—¶-67%, Tokenæ¶ˆè€—-60%ï¼‰
âœ… **æ–‡æ¡£å®Œå–„** - æä¾›è¯¦ç»†çš„é›†æˆè§„åˆ’ã€å¿«é€Ÿå¯åŠ¨å’Œæ•…éšœæ’æŸ¥æŒ‡å—

**Stage-Aware Agent å·²ç»å‡†å¤‡å¥½ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼é›†æˆï¼** ğŸš€

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-10-27
**ä½œè€…**: Claude Code
